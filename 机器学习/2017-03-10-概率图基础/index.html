<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="机器学习,概率图,基础" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="概率是一个好工具，这个工具的核心在于概率的条件独立性质。或者说高级一点条件期望。没有条件期望，概率论不过是测度论的一个表现形式。正是我们定义了条件概率，概率论才枝深叶茂起来。但是表达条件概率不仅仅用数学公式，还可以用图。于是一门新的学科诞生了：概率图。本文通过清晰的数学符号，简洁的描述带你入门概率图。">
<meta name="keywords" content="机器学习,概率图,基础">
<meta property="og:type" content="article">
<meta property="og:title" content="概率图基础">
<meta property="og:url" content="http://www.limoncc.com/机器学习/2017-03-10-概率图基础/index.html">
<meta property="og:site_name" content="柠檬CC">
<meta property="og:description" content="概率是一个好工具，这个工具的核心在于概率的条件独立性质。或者说高级一点条件期望。没有条件期望，概率论不过是测度论的一个表现形式。正是我们定义了条件概率，概率论才枝深叶茂起来。但是表达条件概率不仅仅用数学公式，还可以用图。于是一门新的学科诞生了：概率图。本文通过清晰的数学符号，简洁的描述带你入门概率图。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://www.limoncc.com/images/有向图模型.png">
<meta property="og:image" content="http://www.limoncc.com/images/贝叶斯球算法.png">
<meta property="og:image" content="http://www.limoncc.com/images/图模型比较.png">
<meta property="og:image" content="https://www.limoncc.com/images/cc.png">
<meta property="og:image" content="https://www.limoncc.com/images/avatar.png">
<meta property="og:updated_time" content="2022-01-02T12:53:06.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="概率图基础">
<meta name="twitter:description" content="概率是一个好工具，这个工具的核心在于概率的条件独立性质。或者说高级一点条件期望。没有条件期望，概率论不过是测度论的一个表现形式。正是我们定义了条件概率，概率论才枝深叶茂起来。但是表达条件概率不仅仅用数学公式，还可以用图。于是一门新的学科诞生了：概率图。本文通过清晰的数学符号，简洁的描述带你入门概率图。">
<meta name="twitter:image" content="http://www.limoncc.com/images/有向图模型.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: '博主'
    }
  };
</script>

  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <title> 概率图基础 | 柠檬CC </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-73837972-3', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?d225b8f8559eb2eb6a8bd8792e01ebb9";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=60130136";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">柠檬CC</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">小白爱吃柠檬O(∩_∩)O</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-poetry">
          <a href="/poetry" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-leaf"></i> <br />
            
            诗集
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                概率图基础
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-03-10T21:37:57+08:00" content="2017-03-10">
              2017-03-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
             <span id="/机器学习/2017-03-10-概率图基础/" class="leancloud_visitors" data-flag-title="概率图基础">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>作者: <a href="https://www.limoncc.com">引线小白</a>-本文永久链接：<a href="https://www.limoncc.com/机器学习/2017-03-10-概率图基础/">https://www.limoncc.com/机器学习/2017-03-10-概率图基础/</a><br>知识共享许可协议: 本博客采用<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">署名-非商业-禁止演绎4.0</a>国际许可证</p>
<blockquote>
<p><a style="font-family:Times New Roman;font-size:15px;font-style:italic;font-weight:bold;color:re">Knowledge is the antidote to fear.</a><br><strong>摘要</strong>：本文意在理解与分析图模型。若有错误，请大家指正。<br><strong>关键词</strong>: <code>图模型</code>,<code>图论</code>,<code>有向图</code>,<code>无向图</code></p>
</blockquote>
<h4 id="一、问题来源"><a href="#一、问题来源" class="headerlink" title="一、问题来源"></a>一、问题来源</h4><p>有向图模型($\displaystyle \textit{Directed Graphical Models}$)又称贝叶斯网络($\displaystyle \textit{Bayes Nets}$)。</p>
<hr>
<blockquote>
<p>对于用简单方法来训练复杂系统，我基本知道两个原则：模块化和抽象化。在机器学习领域，我是计算概率的辩护者。因为我相信概率论用它深入和迷人的方式执行了两个原则——因子分解与平均。在我看来，充分利用这两种机制是机器学习的前进方向。—— $\displaystyle \textit{Michael Jordan 1997}$ $\displaystyle \textit{(quted in(Frey 1998)}$</p>
</blockquote>
<hr>
<p>假设我们观察多个相关变量，例如文档中的单词、图像中的像素或微阵列中的基因。</p>
<p>1、我们如何能简洁地表示联合分布 $\displaystyle p\big(\bm{x}\mid \bm{\theta}\big)$？<br>2、在合理的计算时间内，给定其他，我们如何利用这个分布来推断一组变量?<br>3、我们如何通过合理的数据量来学习这个分布的参数?</p>
<p>这些问题是概率建模、推断和学习的核心，也是概率图的主题。我们参照 $\displaystyle \textit{Matlab}$的向量形式定义如下符号：$\displaystyle \bm{x}_{1:t-1}=x_t,\cdots,x_{t-1}$。定义如下术语：条件概率表格<code> CPTs</code> $\displaystyle \textit{(conditional probability tables)}$、条件概率密度 <code>CPD</code>$\displaystyle \textit{(conditional probability distribution)}$、条件独立 <code>CI</code>$\displaystyle \textit{(Conditional independence)}$</p>
<p>我们来考察一下马尔可夫模型：<font face="微软雅黑" size="2" color="red">给定现在，未来独立于过去。</font> 这叫做一阶马尔可夫假设(二元模型假设)<br>$$\begin{align}<br>p(\bm{x})=p(x_1)\prod_{t=2}^Tp\big(x_t\mid x_{t-1}\big)<br>\end{align}$$<br>尽管一阶马尔可夫假设对于定义一维序列的分布很有用，但是如何定义二维图像的分布，或者三维视频，或者更一般的：任意变量集合(例如属于某些生物通路的基因)？这正是我们引入图模型的切入点。</p>
<p>一个图模型是应用条件独立假设来表达联合概率分布的方法。是一套能简洁紧凑地表达变量关系的工具。下面我们将不厌其烦的对图论术语下定义(这些术语都是顾名思义的)和显然的。</p>
<h4 id="二、基本概念"><a href="#二、基本概念" class="headerlink" title="二、基本概念"></a>二、基本概念</h4><h5 id="2-1、图模型的基本符号"><a href="#2-1、图模型的基本符号" class="headerlink" title="2.1、图模型的基本符号"></a>2.1、图模型的基本符号</h5><p>图 $graph$： $\displaystyle  \mathcal{G}=\{V,E\}$<br>节点集 $nodes$： $\displaystyle V(\mathcal{G})$<br>边集 $edges$： $\displaystyle E(\mathcal{G})=\{st\mid s,t\in V\}$<br>阶 $order$： $\displaystyle n=n(\mathcal{G})=\mid\mathcal{G}\mid$<br>边数 $edges numbers$： $\displaystyle e=e(\mathcal{G})=\parallel\mathcal{G}\parallel$</p>
<h5 id="2-2、节点与边的符号"><a href="#2-2、节点与边的符号" class="headerlink" title="2.2、节点与边的符号"></a>2.2、节点与边的符号</h5><p>【节点】：引入一个符号 $\displaystyle v_s$，表示第 $\displaystyle s$个节点，这意味着我们也可以用 $\displaystyle s$表示第 $\displaystyle s$个节点。我们将会根据上下文，灵活使用这两种表示符号。</p>
<p>【边】：引入另外一个符号来表示边</p>
<!-- 作者：引线小白
邮箱：limoncc@icloud.com
网址：www.limoncc.com  -->
<p>有向边：$\displaystyle s\to t=v_s\to v_t\Rightarrow\mathcal{G}(s,t)=1\Rightarrow &lt;st>\in E(\mathcal{G})$<br>无向边：$\displaystyle s-t=v_s-v_t\Rightarrow \mathcal{G}(s,t)=1\land\mathcal{G}(s,t)=1\Rightarrow(st)\in E(\mathcal{G})$<br>某种边：$\displaystyle s\rightleftarrows t=v_s\rightleftarrows v_t\Rightarrow \mathcal{G}(s,t)=1\lor\mathcal{G}(s,t)=1\Rightarrow st\in E(\mathcal{G})$<br>没有边：$\displaystyle \require{cancel} s\cancel{\rightleftarrows}t\Rightarrow\mathcal{G}(s,t)=0\Rightarrow st \notin E(\mathcal{G})$</p>
<p>【分类】如果一个图的所有边都是有向边，则称其为有向图 $\displaystyle \textit{(Directed Graph)}$；如果都是无向边，则称其为无向图 $\displaystyle \textit{(Undirected Graph)}$；如果皆有之，则称其为混合图$\displaystyle \textit{(Mixed Graph)}$</p>
<h5 id="2-3、关于节点认识"><a href="#2-3、关于节点认识" class="headerlink" title="2.3、关于节点认识"></a>2.3、关于节点认识</h5><h6 id="2-3-1、有向图下的节点基本概念"><a href="#2-3-1、有向图下的节点基本概念" class="headerlink" title="2.3.1、有向图下的节点基本概念"></a>2.3.1、有向图下的节点基本概念</h6><p>一个节点的 $Parent$父节点集: $\displaystyle pa(s)=\{t\mid\mathcal{G}(t,s)=1,t\in V(\mathcal{G})\}$<br>一个节点的 $Child$子节点集: $\displaystyle ch(s)=\{t\mid\mathcal{G}(s,t)=1,t\in V(\mathcal{G}) \}$<br>一个节点的 $Family$族节点集: $\displaystyle fam(s)=\{s\}\cup Pa(s)$</p>
<p>一个节点是 $root$根: $\displaystyle \exists  pa(s)=\emptyset\to \textit{s is a root}$<br>一个节点是 $leaf$叶: $\displaystyle \exists ch(s)=\emptyset\to \textit{s is a leaf}$</p>
<p>一个节点的 $Ancestors$祖节点集： $\displaystyle an(s)=\{t\mid t\leadsto s\}$<br>一个节点的 $Descendants$孙节点集： $\displaystyle de(s)=\{t\mid s\leadsto t\}$</p>
<p>拓扑序 $\displaystyle \textit{(Topological Ordering)}$<br>一个节点下标序列满足 $\displaystyle x_s\to x_t\Rightarrow s&lt;t$，也就是说父节点下标比子节点的小。这种下标排序成为图 $\displaystyle \mathcal{G}$的一个拓扑序。</p>
<h6 id="2-3-2、任意图下的节点基本概念"><a href="#2-3-2、任意图下的节点基本概念" class="headerlink" title="2.3.2、任意图下的节点基本概念"></a>2.3.2、任意图下的节点基本概念</h6><p>邻接点 $Neighbour$: $\displaystyle nb(s)=\{t\mid\mathcal{G}(s,t)=1\lor \mathcal{G}(t,s)=1,t\in V(\mathcal{G})  \}$</p>
<p>边界点 $Boundary$: $\displaystyle bd(s)= pa(s)\cap nb(s)$</p>
<p>节点度 $degree$： $\displaystyle d(v)=\mid E(v)\mid$ 含义是关联到节点 $\displaystyle v$的边的条数。特别的，对于有向图。有入度in-degree（父节点数量），出度out-degree（子节点数量）。</p>
<h5 id="2-4、关于边的认识"><a href="#2-4、关于边的认识" class="headerlink" title="2.4、关于边的认识"></a>2.4、关于边的认识</h5><p>路 $\displaystyle \textit{(Path)}$<br>有节点集合 $\displaystyle  P=\{v_1,\cdots,v_k\},k\geqslant 3$， 若有 $\displaystyle \forall v_i\in P\subseteq V(\mathcal{G})\Rightarrow v_i\to v_{i+1}\lor v_i-v_{i+1}$存在，那么就说该节点集合 $\displaystyle P$在图 $\displaystyle \mathcal{G}$中形成了一条路径，记为 $\displaystyle \mathcal{G}_P$。</p>
<p>迹 $\displaystyle \textit{(Trail)}$<br>有节点集合 $\displaystyle  T=\{v_1,\cdots,v_k\},k\geqslant 3$， 若有 $\displaystyle \forall v_i\in T\subseteq V(\mathcal{G})\Rightarrow v_i\rightleftarrows v_{i+1}$存在，那么就说该节点集合 $\displaystyle T$在图 $\displaystyle \mathcal{G}$中形成了一条迹，记为 $\displaystyle \mathcal{G}_T$。</p>
<p>环 $\displaystyle \textit{(Cycle)}$<br>节点集合 $\displaystyle  C=\{v_1,\cdots,v_k\}$是图 $\displaystyle \mathcal{G}$的一条路，若还有 $\displaystyle v_k\to v_1\lor v_k-v_{1}$存在，这称节集合  $\displaystyle C$在图 $\displaystyle \mathcal{G}$中的形成了一个环，记为 $\displaystyle \mathcal{G}_C$。如果一个图不包含环，称该图为无环图 $\displaystyle \textit{(Acyclic Graph)}$。</p>
<p>圈 $\displaystyle \textit{(Loop)}$<br>节点集合 $\displaystyle  L=\{v_1,\cdots,v_k\}$是图 $\displaystyle \mathcal{G}$的一条迹，若有 $\displaystyle v_k\rightleftarrows  v_1$存在，这称节点集合   $\displaystyle L$在图 $\displaystyle \mathcal{G}$中形成了一个圈，记为 $\displaystyle \mathcal{G}_L$。</p>
<p>连通<br>非空图 $\displaystyle \mathcal{G}$的任意两个节点都有一条路存在，就成 $\displaystyle \mathcal{G}$是连通的。</p>
<p>无圈图是森林，特别的有向无圈图是多重树，如果每个节点至多只有一个父节点，则该有向图为森林，连通的森林是树。</p>
<p>弦<br>图 $\displaystyle \mathcal{G}$中的一个圈 $\displaystyle \mathcal{G}_L$，在 $\displaystyle L$中不连贯的节点的边成为弦。</p>
<h5 id="2-5、导出子图与团"><a href="#2-5、导出子图与团" class="headerlink" title="2.5、导出子图与团"></a>2.5、导出子图与团</h5><p>导出子图 $\displaystyle \textit{(Induced Subgraph)}$<br>在概率图中，我们关心的是导出子图：若 $\displaystyle A\subseteq V(\mathcal{G})$, 由 $\displaystyle A$生产一个图 $\displaystyle \mathcal{G}_A$，且 $\displaystyle E(\mathcal{G}_A)=\{st\mid \forall st\in E(\mathcal{G})\land s,t\in A\} $，我们称 $\displaystyle \mathcal{G}_A$是 $\displaystyle A$在图 $\displaystyle \mathcal{G}$中的导出子图。也就是说 $A= V(\mathcal{G}_{A})\subseteq V(\mathcal{G})$， $E(\mathcal{G}_A)\subseteq E(\mathcal{G})$</p>
<p>团 $\displaystyle \textit{(clique)}$<br>若导出子图 $\displaystyle  \mathcal{G}_A$中，这个命题成立：$\displaystyle \forall s,t \in A\to \mathcal{G}_A(s,t)=1$；也就是说 $\displaystyle A$中的任意节点都有一条边，就称 $\displaystyle A$为团。特别的 $\displaystyle \forall B\supset A,B\subseteq V(\mathcal{G})$， $\displaystyle B$不是团，我们就称 $\displaystyle A$为极大团 $\displaystyle \textit{(Maximal Clique)}$。</p>
<h5 id="2-6、有向图与联合分布"><a href="#2-6、有向图与联合分布" class="headerlink" title="2.6、有向图与联合分布"></a>2.6、有向图与联合分布</h5><p>有向图中，联合概率分布根据链式法则可以表示为一系列条件概率的乘积。我们将条件概率分布的条件的随机变量，作为边的起点。这样有:</p>
<div align="center"><img src="http://www.limoncc.com/images/有向图模型.png" width="600" ==""><br>有向图与联合分布</div>


<h4 id="三、有向无环图模型-displaystyle-textit-DGM-or-DAG"><a href="#三、有向无环图模型-displaystyle-textit-DGM-or-DAG" class="headerlink" title="三、有向无环图模型$\displaystyle \textit{ (DGM or DAG) }$"></a>三、有向无环图模型$\displaystyle \textit{ (DGM or DAG) }$</h4><p>任意图模型的核心是一组条件独立假设。我们发现有不同方法来描述有向无环图模型 $\displaystyle \textit{(Directed Aclyclic Graphy)}$的这些条件独立假设，最后我们可以证明它们说的是一个意思。</p>
<h5 id="3-1、有向马尔可夫性质"><a href="#3-1、有向马尔可夫性质" class="headerlink" title="3.1、有向马尔可夫性质"></a>3.1、有向马尔可夫性质</h5><p>【有序马尔可夫性质 $\displaystyle O$】: 给定一个有向无环图的拓扑序 $\displaystyle \{1,\cdots,k,\cdots,K\}$，则有 $\displaystyle  p(\bm{x})=\prod_{k=1}^Kp\big(x_k\mid Pa(x_k)\big)$。也就是说：给定父节点，当前节点与前置节点独立<br>$$\begin{align}<br>O=\left\{S\mid S:\forall x_k\in V(\mathcal{G})\to  x_k\perp_\mathcal{G} \bm{x}_{pred(k)-pa(k)}\mid \bm{x}_{pa(k)}\right\}<br>\end{align}$$</p>
<p>【有向局部马尔可夫性质 $\displaystyle L$】: 给定父节点，当前节点与非后代节点独立<br>$$\begin{align}<br>L=\{S\mid S:\forall x_t\in V(\mathcal{G})\to x_t\perp_\mathcal{G} \bm{x}_{nd(t)-pa(t)}\mid \bm{x}_{pa(t)}\}<br>\end{align}$$<br>其中 $\displaystyle nd(t)=V(\mathcal{G})-\{t\}\cup de(t)$，且有$\displaystyle pred(t)\subseteq nd(t)$。</p>
<p>【全局马尔可夫性质 $\displaystyle G$】<br>$$\begin{align}<br>G=\{S \mid S:\bm{x}_A\perp_\mathcal{G}\bm{x}_B\mid \bm{x}_C\land A,B,C\subseteq V(\mathcal{G})\}<br>\end{align}$$<br>这些性质统称有向马尔可夫性质，它们之间是等价的。没错是等价的！！！</p>
<h5 id="3-2、有向马尔可夫性质定理"><a href="#3-2、有向马尔可夫性质定理" class="headerlink" title="3.2、有向马尔可夫性质定理"></a>3.2、有向马尔可夫性质定理</h5><p>$$\begin{align}<br>O\Longleftrightarrow L \Longleftrightarrow G<br>\end{align}$$</p>
<h5 id="3-3、有向分离与贝叶斯球算法"><a href="#3-3、有向分离与贝叶斯球算法" class="headerlink" title="3.3、有向分离与贝叶斯球算法"></a>3.3、有向分离与贝叶斯球算法</h5><h6 id="3-3-1、迹的有向分离"><a href="#3-3-1、迹的有向分离" class="headerlink" title="3.3.1、迹的有向分离"></a>3.3.1、迹的有向分离</h6><!-- 作者：引线小白
邮箱：limoncc@icloud.com
网址：www.limoncc.com  -->
<p>如何找到全局马尔可夫性质，下面我们引入有向分离 $\displaystyle \textit{(D-Separation)}$的概念,<br>首先，我们说一条迹 $\displaystyle T$被节点集 $\displaystyle E\textit{ (containing the evidence)}$有向分离，那么该迹至少满足下面一条：<br>1、 $\displaystyle T$ 含有链迹 $\displaystyle  x\to y\to z$ 或者 $\displaystyle x\leftarrow y\leftarrow z$，且 $\displaystyle y\in E$</p>
<p>2、 $\displaystyle T$ 含有叉迹 $\displaystyle x \swarrow ^y \searrow z$，且 $\displaystyle y\in E$</p>
<p>3、$\displaystyle T$ 含有撞迹 $\displaystyle x \searrow _y \swarrow z$,且 $\displaystyle y,\notin E \land de(y)\cap E=\emptyset$</p>
<h6 id="3-3-2、节点集的有向分离"><a href="#3-3-2、节点集的有向分离" class="headerlink" title="3.3.2、节点集的有向分离"></a>3.3.2、节点集的有向分离</h6><p>接下来，我们说给定已观测节点集 $\displaystyle E$，一节点集合 $\displaystyle A$与另一节点集<br><!-- 作者：引线小白
邮箱：limoncc@icloud.com
网址：www.limoncc.com  --> $\displaystyle B$有向分离，意思是说，对于每一条 $\displaystyle a\in A$到 $\displaystyle b\in B$的迹被节点集 $\displaystyle E\textit{ (containing the evidence)}$有向分离。</p>
<h6 id="3-3-3、有向无环图的条件独立性质"><a href="#3-3-3、有向无环图的条件独立性质" class="headerlink" title="3.3.3、有向无环图的条件独立性质"></a>3.3.3、有向无环图的条件独立性质</h6><p>最后，我们就能把图的分离性定义与分布的条件独立性质结合起来：<br>$$\begin{align}<br>\bm{x}_A\perp_\mathcal{G}\bm{x}_B\mid \bm{x}_E  \iff \textit{ A is d-separation from B given E}<br>\end{align}$$</p>
<p>我们来详细考察一下：<br>【链迹】考察联合分布 $\displaystyle p(x,y,z)=p(x)p(y\mid x)p(z\mid y)$，然后我们考察基于 $\displaystyle y$的条件分布：<br>$$\begin{align}<br>p(x,z\mid y)=\frac{p(x)p(y\mid x)p(z\mid y)}{p(y)}=\frac{p(x,y)p(z\mid y)}{p(y)}=p(x\mid y)p(z\mid y)\iff x \perp z\mid y<br>\end{align}$$</p>
<p>【叉迹】考察联合分布 $\displaystyle p(x,y,z)=p(y)p(x\mid y)p(z\mid y)$，同样我们考察  $\displaystyle y$的分布：<br>$$\begin{align}<br>p(x,z\mid y)=\frac{p(y)p(x\mid y)p(z\mid y)}{p(y)}=p(x\mid y)p(z\mid y)\iff x \perp z\mid y<br>\end{align}$$</p>
<p>【撞迹】考察联合分布 $\displaystyle p(x,y,z)=p(x)p(z)p(y\mid x,z)$，同样我们考察  $\displaystyle y$的分布：<br>$$\begin{align}<br>p(x,z\mid y)=\frac{p(x)p(z)p(y\mid x,z)}{p(y)}\iff x \require{cancel} \cancel{\perp} z\mid y<br>\end{align}$$<br>但是，我们发现<br>$$\begin{align}<br>p(x,z)=\int p(x)p(z)p(y\mid x,z) dy=p(x)p(z)\iff x\perp z<br>\end{align}$$<br>我们把撞迹的这种现象叫解释消除 $\displaystyle \textit{(explaining away)}$</p>
<h6 id="3-3-4、贝叶斯球算法"><a href="#3-3-4、贝叶斯球算法" class="headerlink" title="3.3.4、贝叶斯球算法"></a>3.3.4、贝叶斯球算法</h6><p>贝叶斯球算法 $\displaystyle \textit{(shachter 1998)}$是一种判断节点集是否有向分离的简单方法：</p>
<div align="center"><img src="http://www.limoncc.com/images/贝叶斯球算法.png" width="550" ==""><br>贝叶斯球算法</div>

<h5 id="3-4、马尔可夫毯与全条件"><a href="#3-4、马尔可夫毯与全条件" class="headerlink" title="3.4、马尔可夫毯与全条件"></a>3.4、马尔可夫毯与全条件</h5><p>下面我们将考察单个节点与其他节点的独立性质。我们定义图中所有与 $\displaystyle t$节点独立的其他节点集称为 $ t$的马尔可夫毯 <strong>Markov Blanket </strong>，记为 $\displaystyle mb(t)$。 特别的在有向无环图中一个节点的马尔可夫毯是父节点、子节点、同父节点 <strong>(co-parents) </strong>(或者说它子节点的父节点)的集合。即：<br>$$\begin{align}<br>mb(t)=ch(t)\cup pa(t) \cup copa(t)<br>\end{align}$$</p>
<p>为何同父节点在马尔科夫毯中？注意到：</p>
<p>$$\begin{align}<br>p\big(x_t\mid \bm{x}_{-t}\big)= \frac{ p\big(x_t ,\bm{x}_{-t}\big)}{ p\big( \bm{x}_{-t}\big)}<br>\end{align}$$</p>
<p>其中所有不包含 $\displaystyle x_t$的项将在分子和分母之间被消掉，所以在这个视角下只剩下含有 $\displaystyle x_t$的概率密度的乘积。这个一点使用贝叶斯球算法的链迹、叉迹、撞迹、阻塞、反弹的概念判定独立不难理解。因此有：</p>
<p> $$\begin{align}<br> p\big(x_t\mid \bm{x}_{-t}\big)<br> \propto p \big(x_t\mid \bm{x}_{pa(t)}\big)\prod_{s\in ch(t)}p \big(x_s\mid \bm{x}_{pa(s)}\big)<br> \end{align}$$</p>
<p>得到的表达式被称为 $\displaystyle t$节点的全条件 <strong>(Full Conditional) </strong>，当我们学习吉布斯抽样时这一结论是非常重要的。</p>
<h4 id="四、图模型与联合概率分布"><a href="#四、图模型与联合概率分布" class="headerlink" title="四、图模型与联合概率分布"></a>四、图模型与联合概率分布</h4><p>图模型是一种语言，联合概率分布也是一种语言。它们可以表达相同的事物。正如几何与代数的关系。下面我们将引入一系列定义，以方便寻找它们的联系。</p>
<h5 id="4-1、图模型的条件独立性质与-displaystyle-text-I-Map"><a href="#4-1、图模型的条件独立性质与-displaystyle-text-I-Map" class="headerlink" title="4.1、图模型的条件独立性质与 $\displaystyle \text{I-Map}$"></a>4.1、图模型的条件独立性质与 $\displaystyle \text{I-Map}$</h5><p>我们即将引入 $\displaystyle \text{I-Map}$的概念与定义，以方便简洁表达。这种手法是发展数学的动力之一。我们知道：任意图模型 $\displaystyle \mathcal{G}$的核心是一组条件独立假设集合，可以记为</p>
<p>$$\begin{align}<br>\bm{x}_A\perp_\mathcal{G}\bm{x}_B\mid \bm{x}_C<br>\end{align}$$</p>
<p>我们根据这一叙述可以定义一个“陈述” $\displaystyle \textit{(Senantics)}$。 $\displaystyle S:\bm{x}_A\perp_\mathcal{G}\bm{x}_B\mid \bm{x}_C$, $\displaystyle A,B,C\subseteq V(\mathcal{G})$。然后我们把“所有条件独立陈述的集合”定义为：$\displaystyle \mathcal{I}(\mathcal{G})=\{S\}$。也就是说：$\displaystyle\mathcal{I}(\mathcal{G})$是图模型 $\displaystyle \mathcal{G}$的所有条件独立陈述的集合。</p>
<p>同样样给出一个联合概率分布 $\displaystyle p$的所有条件独立陈述的集合，记为： $\displaystyle \mathcal{I}(p)$。 </p>
<p>当然这些陈述是可以判断真假的，是真命题。至于为什么没有直接使用“命题的集合”这个的术语，考虑到我们是在给现实世界建模，而模型是否为真，还不一定，使用“陈述”这一术语是恰当的。</p>
<p>特别的：“一个联合分布 $\displaystyle p$满足一个图模型 $\displaystyle \mathcal{G}$的所有条件独立假设”。这句话可以写为：<br>$$\begin{align}<br>\mathcal{I}(\mathcal{G})\subseteq \mathcal{I}(p)<br>\end{align}$$<br>这种情况下，我们就说“图  $\displaystyle \mathcal{G}$是分布 $\displaystyle p$的一个 $\displaystyle\text{I-Map}$”。很快我们就会发现关于 $\displaystyle\mathcal{I}(\mathcal{G})$定义中的“所有”并不是必须的。也就说一个 $\displaystyle p$的 $\displaystyle\text{I-Map}$可以有很多个，例如完全图是任意分布的 $\displaystyle p$的 $\displaystyle\text{I-Map}$。</p>
<h5 id="4-2、因子分解"><a href="#4-2、因子分解" class="headerlink" title="4.2、因子分解"></a>4.2、因子分解</h5><p>同样，我们引入因子分解 $\displaystyle \textit{(factorization)}$的概念与定义。注意因子分解应该理解为一个动词。</p>
<p>若有向无环图模型 $\displaystyle \mathcal{G} $，有随机变量集(节点集) $\displaystyle \mathcal{X}=V(\mathcal{G})=\{x_i\}_{i=1}^n$，如果联合分布 $\displaystyle p$能表示为如下乘积形式：$$\begin{align}<br>\displaystyle  p(\bm{x})=\prod_{i=1}^np\big(x_i\mid \bm{x}_{pa(i)}\big)<br>\end{align}$$那么我们称联合分布 $\displaystyle p$基于图 $\displaystyle \mathcal{G}$在同一空间 $\displaystyle \mathcal{X}$ 上因子分解 ($\displaystyle \textit{ p over the same space } $$\displaystyle  \mathcal{X}$ $\displaystyle \textit{ factorizes according to }\mathcal{G}$)，记为 $\displaystyle F$。</p>
<h5 id="4-3、条件独立因子分解定理"><a href="#4-3、条件独立因子分解定理" class="headerlink" title="4.3、条件独立因子分解定理"></a>4.3、条件独立因子分解定理</h5><!-- 作者：引线小白
邮箱：limoncc@icloud.com
网址：www.limoncc.com  -->
<p>$$\begin{align}<br>\mathcal{I}(\mathcal{G})\subseteq \mathcal{I}(p)\Longleftrightarrow p(\bm{x})=\prod_{i=1}^np\big(x_i\mid \bm{x}_{pa(i)}\big)<br>\end{align}$$</p>
<p>也就是说一个联合分布 $\displaystyle p$满足一个图模型 $\displaystyle \mathcal{G}$的所有条件独立假设，与联合分布 $\displaystyle p$基于图 $\displaystyle \mathcal{G}$在同一空间 $\displaystyle \mathcal{X}$ 上因子分解等价。</p>
<p>于是我们有：<br>$$\begin{align}<br>O\Longleftrightarrow L \Longleftrightarrow G \Longleftrightarrow F<br>\end{align}$$</p>
<h4 id="五、无向图模型-Undirected-Graphical-Model-UGM"><a href="#五、无向图模型-Undirected-Graphical-Model-UGM" class="headerlink" title="五、无向图模型(Undirected Graphical Model(UGM))"></a>五、无向图模型(Undirected Graphical Model(UGM))</h4><h5 id="5-1、UGMs的特点"><a href="#5-1、UGMs的特点" class="headerlink" title="5.1、UGMs的特点"></a>5.1、UGMs的特点</h5><p>无向图模型 <strong>Undirected Graphical Model(UGM) </strong>，也称为马尔可夫随机场 <strong>Markov random field(MRF) </strong>或马尔可夫网络。它不要求我们指定边方向，而且对于一些问题，如图像分析和空间统计，更自然。</p>
<p><strong>UGMs </strong>相对 <strong>DGMs </strong>的主要优势是:<br>(1)它们是对称的，因此对于某些领域(如空间或关系数据)更“自然”;<br>(2)定义 $\displaystyle p \big(\bm{y}\mid \bm{x}\big)$条件密度的判别 <strong>UGMs </strong>(即条件随机场 <strong>Conditional random ﬁelds, or CRFs </strong>)，比判别 <strong>DGMs </strong>更有效。</p>
<p>与 <strong>DGMs </strong>相比， <strong>UGMs </strong>的主要缺点是:<br>(1)参数的可解释性更小，模块化更少。<br>(2)参数估计在计算成本上更加昂贵。</p>
<h5 id="5-2、UGMs的条件独立性质"><a href="#5-2、UGMs的条件独立性质" class="headerlink" title="5.2、UGMs的条件独立性质"></a>5.2、UGMs的条件独立性质</h5><p><strong>UGMs </strong>通过简单的图分离来定义 <strong>CI </strong>关系。对于节点 $ A$、 $ B$和 $ C$的集合，如果在图 $ \mathcal{G}$中 $ C$把 $ A$从 $ B$分离，我们就说 $\displaystyle \bm{x}_A \perp_{\mathcal{G}} \bm{x}_b\mid \bm{x}_c$。这意味着，当我们删除 $ C$中所有节点，如果没有任何路(Path)连接 $ A$中任何节点到 $ B$中的任何节点，就称 <strong>CI </strong>性质。这被称为 <strong>UGMs </strong>的全局马尔可夫性质 <strong>(global Markov property) </strong>。</p>
<p>在一个图中，使与节点 $ t$有条件独立性质最小节点集称为 $ t$的马尔可夫毯 <strong>Markov blanket </strong>；我们将用 $ mb(t)$表示。在形式上，马尔可夫毯满足以下性质:</p>
<p>$$\begin{align}<br>t\perp V(\mathcal{G})-cl(t)\mid mb(t)<br>\end{align}$$</p>
<p>其中 $\displaystyle cl(t)=mb(t)\cup \{t\}$是节点 $ t$的闭包 <strong>(closure) </strong>。易知，在一个 <strong>UGM </strong>中，节点的马尔可夫毯是它紧邻的集合。这叫做无向局部马尔可夫性质。</p>
<p>从局部马尔可夫性质，我们可以很容易看出如果两个节点之间没有直接连接的边，给定其余节点，它们是条件独立的。这叫做成对马尔可夫性质<strong>(Pairwise Markov Property) </strong>记为 $ P$ 。</p>
<p>$$\begin{align}<br>s\perp t \mid V(\mathcal{G})-\{s,t\}\iff \mathcal{G}(s,t)=0<br>\end{align}$$</p>
<p>很明显，全局马尔可夫性质包含了局部马尔可夫性质，它意味着成对马尔可夫性质。虽然不那么明显，但仍然是正确的(假设对所有 $ x$的 $ p(x)&gt;0$，即 $ p$是一个正密度)，这时成对马尔可夫性蕴含全局马尔可夫性质，因此所有这些马尔可夫性质都是等价的，如图19.3所示(参见Koller和Friedman 2009,p119)。这一结果的重要性在于，它通常更容易根据经验来评估成对条件独立性；可以使用这种成对条件独立性语句构造一个图形，而从这个图中提取的全局独立性语句也成立。</p>
<p>$$\begin{align}<br> G\Longrightarrow L  \Longrightarrow P \mathop{===\Longrightarrow}^{\forall x\to p(x)&gt;0} G<br>\end{align}$$</p>
<p>或者说<br>$$\begin{align}<br>\forall x\to p(x)&gt;0  \Rightarrow G \iff L \iff P<br>\end{align}$$</p>
<h5 id="5-3、Hammersley-Clifford定理"><a href="#5-3、Hammersley-Clifford定理" class="headerlink" title="5.3、Hammersley-Clifford定理"></a>5.3、Hammersley-Clifford定理</h5><p>由于没有与无向图相关的拓扑排序，我们不能使用链式法则来表示 $ p \big(\bm{x}\big)$。因此，我们将概率密度与每个节点关联起来替换方法是，将势函数或因子与图中每个极大团联系起来。我们将团 $ c$势函数记为 $ \psi_c \big(\bm{x}_c\mid \bm{\theta}_c\big)$。势函数可以是其参数的任何非负函数。然后定义联合分布与团势函数乘积成比例。令人惊讶的是，可以通过这样的方式来表示任何可以由无向图模型表达条件独立性质的正分布。我们更正式地陈述这个结果如下</p>
<p>【 <strong>Hammersley-Clifford </strong>定理】<br>一个正分布 $ p \big(\bm{x}\big)&gt;0$ 能满足一个无向图模型 $ \mathcal{G}$的条件独立性质，当且仅当 $ p$能够被每个极大团因子的乘积表示。</p>
<!-- 作者：引线小白
邮箱：limoncc@icloud.com
网址：www.limoncc.com  -->
<p>$$\begin{align}<br>\forall x\to p(x)&gt;0\Rightarrow \mathcal{I}(p)=\mathcal{I}(\mathcal{G})<br>\iff p \big(\bm{x}\mid \bm{\theta}\big)=\frac{1}{Z(\bm{\theta})}\prod_{c\in \mathcal{C}}\psi_c \big(\bm{x}_c\mid \bm{\theta}_c\big)<br>\end{align}$$</p>
<p>其中 $ \mathcal{C}$是图 $ \mathcal{G}$ 所有极大团的集合。 $ Z(\bm{\theta})$是配分函数：<br>$$\begin{align}<br>Z(\bm{\theta})=\sum_{\bm{x}}\prod_{c\in \mathcal{C}}\psi_c \big(\bm{x}_c\mid \bm{\theta}_c\big)<br>\end{align}$$</p>
<p>请注意，配分函数确保了整体分布总和为 $ 1$。证明从未发表过，但可以在例如(Koller and Friedman 2009)中找到。</p>
<h4 id="六、比较有向图模型和无向图模型"><a href="#六、比较有向图模型和无向图模型" class="headerlink" title="六、比较有向图模型和无向图模型"></a>六、比较有向图模型和无向图模型</h4><p>哪一个模型有更强的“表达能力”，是有向图模型还是无向图模型？为了形式化这个问题，回顾一下：如果 $ \mathcal{I}(\mathcal{G})\subseteq \mathcal{I}(p)$，则 $ \mathcal{G}$是一个分布 $ p$的 $\text{I-Map}<br>$。如果 $ \mathcal{I}(\mathcal{G})= \mathcal{I}(p)$，那么就称 $ \mathcal{G}$为 $ p$的完美映射 <strong>(Perfect Map) </strong> $  \text{P-Map}$，换句话说，图可以表示分布的所有(且唯一)条件独立性质。问题就变为：对于不同分布集合，是有向图模型还是无向图模型是完美映射。从这个意义上说，两者都不是比另一个更强大的表示语言。</p>
<p>一些条件独立关系的例子可以完全由有向图模型建模，而无向图模型不能。考虑一个 $ v$结构$  A \searrow _C \swarrow B$，这表示 $ A\perp B$ 且 $\require{cancel}  A\cancel{\perp}   B\mid C$。如果我们去掉箭头，得到 $ A-C-B$，这表示 $\require{cancel} A\cancel{\perp} B$ 且 $  A\perp   B\mid C$。这种去掉箭头的操作显然是不对的。事实上，没有无向图模型能精准完全唯一地表达由 $ v$结构编码的两个条件独立性质。一般的，无向图模型的条件独立性质是单调的，这里的单调有如下含义：如果 $ A \perp B \mid C$，则 $ A\perp B \mid \big(C\cup D\big)$。但在有向图模型中，条件独立性质是非单调的，因为存在附加变量的条件作用可以消除由于解释消除 $\displaystyle \textit{(explaining away)} $生产的条件独立性质。</p>
<div align="center"><img src="http://www.limoncc.com/images/图模型比较.png" width="550" ==""><br>图模型比较</div>

<p>一些条件独立关系的例子可以完全由无向图模型建模的，而有向图模型不能。可以考虑如图(a)所示的 $ 4$环。图(b)显示了用有向图模型建模的尝试，它能正确表达 $ A\perp C \mid B,D$，但表达的 $ B\perp D\mid A$是错误的。图(c)是另一个不正确的有向图模型，它正确地编码了 $ A\perp C \mid B,D$，但是编码的 $ B\perp D$是错误的。事实上，没有有向图模型能够精准完全唯一地表达由这个由无向图模型编码的条件独立陈述集合。</p>
<p>有些分布可以完全由有向图模或无向图模型建模；得到的图称为可分解 <strong>(decomposable)  </strong>或弦 <strong>(chordal) </strong>。粗略地说，这意味着：如果我们把每个最大团的所有变量一起坍缩生成“大变量” <strong>(“mega-variables”,) </strong>，结果图将是一棵树。当然，如果图已经是树了(包括链作为特殊情况)，它将是弦。有关详细信息，我们以后详细介绍。</p>
<h4 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a>七、总结</h4><p>1、概率是一个好工具，这个工具的核心在于概率的条件独立性质。或者说高级一点条件期望。没有条件期望，概率论不过是测度论的一个表现形式。正是我们定义了条件概率，概率论才枝深叶茂起来。但是表达条件概率不仅仅用数学公式，还可以用图。于是一门新的学科诞生了：概率图。<br>2、无论是无向图、有向图，其核心都是一组条件概率假设(或者条件概率陈述)。而在非常宽泛条件下，一组条件概率假设和一个图表意是一致。这就奠定了概率图应用的基础。<br>3、有了图模型这一强有力的可视化建模工具，我们足矣为各种复杂场景建模，星辰大海就在前方，我们将继续探索。</p>
<p><hr></p>
<p><table border="1" width="100%"><tr><td align="center" width="18%">版权声明</td><td align="left" width="82%"><img src="https://www.limoncc.com/images/cc.png" width="18%"></td></tr><tr><td align="center" width="18%"><img src="https://www.limoncc.com/images/avatar.png" width="100%"></td><td align="left" width="82%">由<a href="https://www.limoncc.com">引线小白</a>创作并维护的<a href="http://www.limoncc.com">柠檬CC</a>博客采用<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">署名-非商业-禁止演绎4.0</a>国际许可证。<br>本文首发于柠檬CC <a href="https://www.limoncc.com">[ https://www.limoncc.com ]</a> , 版权所有、侵权必究。</td></tr><tr><td align="center" width="18%">本文永久链接</td><td align="left" width="82%"><a href="https://www.limoncc.com/机器学习/2017-03-10-概率图基础/">https://www.limoncc.com/机器学习/2017-03-10-概率图基础/</a></td></tr></table><div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a><a href="#" class="bds_duitang" data-cmd="duitang" title="分享到堆糖"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a><a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a></div></p>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{},"image":{"viewList":["tsina","douban","weixin","sqq","duitang","qzone","fbook","twi"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","douban","weixin","sqq","duitang","qzone","fbook","twi"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/机器学习/" rel="tag">#机器学习</a>
          
            <a href="/tags/概率图/" rel="tag">#概率图</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/机器学习/2017-03-09-广义线性模型/" rel="next" title="广义线性模型">
                <i class="fa fa-chevron-left"></i> 广义线性模型
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/机器学习/2017-03-11-隐马尔可夫模型/" rel="prev" title="隐马尔可夫模型">
                隐马尔可夫模型 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


<!--           </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div> -->
        <div id="vcomments"></div>
        <script>new Valine({
          el: "#vcomments",
      appId: "BVjuNRCpkVSkz82jFmadIvY8-gzGzoHsz",
    appKey: "bRjXPp55dop7RTC2xgunGdiP"})
  </script>'
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="引线小白" />
          <p class="site-author-name" itemprop="name">引线小白</p>
          <p class="site-description motion-element" itemprop="description">小湖椰影廊桥,曾记否,谷围晓月,灯影朦胧。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">28</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">44</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a rel="external nofollow" href="" target="_blank" title="Design">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Design
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a rel="external nofollow" href="https://www.behance.net/limoncc" target="_blank" title="Behance">
                  
                    <i class="fa fa-fw fa-behance"></i>
                  
                  Behance
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a rel="external nofollow" href="https://www.pinterest.com/aegeanfan/" target="_blank" title="Pinterest">
                  
                    <i class="fa fa-fw fa-pinterest"></i>
                  
                  Pinterest
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a rel="external nofollow" href="https://github.com/limoncc" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a rel="external nofollow" href="http://weibo.com/3483157951" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a rel="external nofollow" href="http://www.zhihu.com/people/limoncc" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              设计不止，折腾不息。
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://chuangzaoshi.com" title="创造狮" target="_blank">创造狮</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#一、问题来源"><span class="nav-number">1.</span> <span class="nav-text">一、问题来源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#二、基本概念"><span class="nav-number">2.</span> <span class="nav-text">二、基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1、图模型的基本符号"><span class="nav-number">2.1.</span> <span class="nav-text">2.1、图模型的基本符号</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2、节点与边的符号"><span class="nav-number">2.2.</span> <span class="nav-text">2.2、节点与边的符号</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3、关于节点认识"><span class="nav-number">2.3.</span> <span class="nav-text">2.3、关于节点认识</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-1、有向图下的节点基本概念"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.3.1、有向图下的节点基本概念</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-3-2、任意图下的节点基本概念"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.3.2、任意图下的节点基本概念</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-4、关于边的认识"><span class="nav-number">2.4.</span> <span class="nav-text">2.4、关于边的认识</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-5、导出子图与团"><span class="nav-number">2.5.</span> <span class="nav-text">2.5、导出子图与团</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-6、有向图与联合分布"><span class="nav-number">2.6.</span> <span class="nav-text">2.6、有向图与联合分布</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#三、有向无环图模型-displaystyle-textit-DGM-or-DAG"><span class="nav-number">3.</span> <span class="nav-text">三、有向无环图模型$\displaystyle \textit{ (DGM or DAG) }$</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1、有向马尔可夫性质"><span class="nav-number">3.1.</span> <span class="nav-text">3.1、有向马尔可夫性质</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2、有向马尔可夫性质定理"><span class="nav-number">3.2.</span> <span class="nav-text">3.2、有向马尔可夫性质定理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-3、有向分离与贝叶斯球算法"><span class="nav-number">3.3.</span> <span class="nav-text">3.3、有向分离与贝叶斯球算法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#3-3-1、迹的有向分离"><span class="nav-number">3.3.1.</span> <span class="nav-text">3.3.1、迹的有向分离</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-3-2、节点集的有向分离"><span class="nav-number">3.3.2.</span> <span class="nav-text">3.3.2、节点集的有向分离</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-3-3、有向无环图的条件独立性质"><span class="nav-number">3.3.3.</span> <span class="nav-text">3.3.3、有向无环图的条件独立性质</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-3-4、贝叶斯球算法"><span class="nav-number">3.3.4.</span> <span class="nav-text">3.3.4、贝叶斯球算法</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-4、马尔可夫毯与全条件"><span class="nav-number">3.4.</span> <span class="nav-text">3.4、马尔可夫毯与全条件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#四、图模型与联合概率分布"><span class="nav-number">4.</span> <span class="nav-text">四、图模型与联合概率分布</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-1、图模型的条件独立性质与-displaystyle-text-I-Map"><span class="nav-number">4.1.</span> <span class="nav-text">4.1、图模型的条件独立性质与 $\displaystyle \text{I-Map}$</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-2、因子分解"><span class="nav-number">4.2.</span> <span class="nav-text">4.2、因子分解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-3、条件独立因子分解定理"><span class="nav-number">4.3.</span> <span class="nav-text">4.3、条件独立因子分解定理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#五、无向图模型-Undirected-Graphical-Model-UGM"><span class="nav-number">5.</span> <span class="nav-text">五、无向图模型(Undirected Graphical Model(UGM))</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1、UGMs的特点"><span class="nav-number">5.1.</span> <span class="nav-text">5.1、UGMs的特点</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2、UGMs的条件独立性质"><span class="nav-number">5.2.</span> <span class="nav-text">5.2、UGMs的条件独立性质</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-3、Hammersley-Clifford定理"><span class="nav-number">5.3.</span> <span class="nav-text">5.3、Hammersley-Clifford定理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#六、比较有向图模型和无向图模型"><span class="nav-number">6.</span> <span class="nav-text">六、比较有向图模型和无向图模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#七、总结"><span class="nav-number">7.</span> <span class="nav-text">七、总结</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">引线小白&nbsp &nbsp |&nbsp &nbsp  一个理想主义者，再造自我，以期未来。</span>
</div>

<div class="powered-by">
  由 <a rel="external nofollow" class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a rel="external nofollow" class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>&nbsp &nbsp| &nbsp &nbsp Hosted by  <a href="https://github.com" style="font-weight: bold">Github Pages</a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



<!--   
   
  

  

 -->
  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
     showMathMenu: false,
     showMathMenuMSIE: false,
     tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
          processEscapes: true
        },
        TeX: {
          equationNumbers: {autoNumber: 'AMS'},
          Macros: {bm: "\\boldsymbol"}
        },
        'HTML-CSS': {
          imageFont: null
        }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("Es7wAnqi0QiGhMLoyl7mkrQo-gzGzoHsz", "BxPXaoPFp3PzWqBTSe6VUuQS");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</body>
</html>
